From 2fe200a7577dcbaf66363334330d601bf67db78a Mon Sep 17 00:00:00 2001
From: Claude <noreply@anthropic.com>
Date: Thu, 13 Nov 2025 19:11:53 +0000
Subject: [PATCH] Change month view events to use left border instead of full
 background

Modified the month view event rendering to improve visual clarity:
- Event boxes now have a semi-transparent white background (20% opacity)
- Event color is displayed as a 4dp left border instead of full background fill
- Event text now uses calendar text color instead of contrasting with event color
- Maintains alpha adjustments for dimmed past events and completed tasks

This change makes events more subtle while still clearly showing their category color.
---
 .../calendar/pro/views/MonthView.kt           | 38 +++++++++++++++++--
 1 file changed, 35 insertions(+), 3 deletions(-)

diff --git a/app/src/main/kotlin/com/simplemobiletools/calendar/pro/views/MonthView.kt b/app/src/main/kotlin/com/simplemobiletools/calendar/pro/views/MonthView.kt
index 3c94320..fbf6544 100644
--- a/app/src/main/kotlin/com/simplemobiletools/calendar/pro/views/MonthView.kt
+++ b/app/src/main/kotlin/com/simplemobiletools/calendar/pro/views/MonthView.kt
@@ -27,6 +27,7 @@ import kotlin.math.min
 // used in the Monthly view fragment, 1 view per screen
 class MonthView(context: Context, attrs: AttributeSet, defStyle: Int) : View(context, attrs, defStyle) {
     private val BG_CORNER_RADIUS = 8f
+    private val EVENT_LEFT_BORDER_WIDTH = 4f
 
     private var textPaint: Paint
     private var eventTitlePaint: TextPaint
@@ -306,6 +307,17 @@ class MonthView(context: Context, attrs: AttributeSet, defStyle: Int) : View(con
         bgRectF.set(bgLeft, bgTop, bgRight, bgBottom)
         canvas.drawRoundRect(bgRectF, BG_CORNER_RADIUS, BG_CORNER_RADIUS, getEventBackgroundColor(event, startDayIndex, endDayIndex))
 
+        // Draw left border with event color
+        val borderPaint = getEventLeftBorderColor(event, startDayIndex, endDayIndex)
+        borderPaint.strokeWidth = EVENT_LEFT_BORDER_WIDTH
+        borderPaint.style = Paint.Style.FILL
+        val borderLeft = bgLeft
+        val borderTop = bgTop
+        val borderRight = bgLeft + EVENT_LEFT_BORDER_WIDTH
+        val borderBottom = bgBottom
+        val borderRectF = RectF(borderLeft, borderTop, borderRight, borderBottom)
+        canvas.drawRoundRect(borderRectF, BG_CORNER_RADIUS, BG_CORNER_RADIUS, borderPaint)
+
         val specificEventTitlePaint = getEventTitlePaint(event, startDayIndex, endDayIndex)
         var taskIconWidth = 0
         if (event.isTask) {
@@ -352,7 +364,8 @@ class MonthView(context: Context, attrs: AttributeSet, defStyle: Int) : View(con
     }
 
     private fun getEventBackgroundColor(event: MonthViewEvent, startDay: DayMonthly, endDay: DayMonthly): Paint {
-        var paintColor = event.color
+        // Use a semi-transparent white/light background instead of event color
+        var paintColor = Color.WHITE
 
         val adjustAlpha = when {
             event.isTask -> dimCompletedTasks && event.isTaskCompleted
@@ -361,14 +374,17 @@ class MonthView(context: Context, attrs: AttributeSet, defStyle: Int) : View(con
         }
 
         if (adjustAlpha) {
-            paintColor = paintColor.adjustAlpha(MEDIUM_ALPHA)
+            paintColor = paintColor.adjustAlpha(0.15f)
+        } else {
+            paintColor = paintColor.adjustAlpha(0.2f)
         }
 
         return getColoredPaint(paintColor)
     }
 
     private fun getEventTitlePaint(event: MonthViewEvent, startDay: DayMonthly, endDay: DayMonthly): Paint {
-        var paintColor = event.color.getContrastColor()
+        // Use calendar text color instead of contrasting with event color
+        var paintColor = textColor
         val adjustAlpha = when {
             event.isTask -> dimCompletedTasks && event.isTaskCompleted
             !startDay.isThisMonth && !endDay.isThisMonth -> true
@@ -385,6 +401,22 @@ class MonthView(context: Context, attrs: AttributeSet, defStyle: Int) : View(con
         return curPaint
     }
 
+    private fun getEventLeftBorderColor(event: MonthViewEvent, startDay: DayMonthly, endDay: DayMonthly): Paint {
+        var paintColor = event.color
+
+        val adjustAlpha = when {
+            event.isTask -> dimCompletedTasks && event.isTaskCompleted
+            !startDay.isThisMonth && !endDay.isThisMonth -> true
+            else -> dimPastEvents && event.isPastEvent && !isPrintVersion
+        }
+
+        if (adjustAlpha) {
+            paintColor = paintColor.adjustAlpha(MEDIUM_ALPHA)
+        }
+
+        return getColoredPaint(paintColor)
+    }
+
     private fun getCirclePaint(day: DayMonthly): Paint {
         val curPaint = Paint(textPaint)
         var paintColor = primaryColor
-- 
2.43.0

